
<style type="text/css">
	

	ul.team-list{
		list-style:none;
		padding:0;
		min-height:12em;
	}
	ul.team-list li:nth-child(2n){
		background-color:#a6dbed;
	}
	.teams{
		margin:10px;
		background-color: #13C4A5;
		padding: 10px;
	}
	li {
		cursor:move;
	}

</style>

<script type="text/javascript">
	function addDesigner(button){
		$('#add-user').modal();
		var s = button;
	}
	$(function() {
		users = <%= @users.to_json.html_safe %>;
		for (var i = 0; i < users.length; i){
			users[i].label=users[i].first_name  " "  users[i].last_name;
		}
		$("#add-user-input").autocomplete({
			source: users
		}).data("uiAutocomplete")._renderItem = function(ul, item) {
			return $("<li>").data("item.autocomplete", item).append("<a>"  item.first_name  "</a>").appendTo(ul);
		};
	});
</script>

<div class="row">

	<!-- SIDEBAR NAVIGATION -->
	<div class="col-sm-2">
		<%= render 'navigation/teams_sidebar_nav' %>
	</div>

	<div class="col-sm-7">
		<% @teams.each do |team| %>
		<div class="section">
			<div class="teams">
				<h1><%= team.name %></h1>

				<ul class="team-list connected-sortable" id="team-<%=team.id%>" data-team-id="<%=team.id%>">
					<!-- drop designers here -->
					<% team.users.each do |designer| %>
					<h2><%= designer.first_name %> <%= designer.last_name %></h2>
					<% end %>
				</ul>
				<%= link_to "Delete Team", team, method: :delete, data: { confirm: "You sure?" } %>
				<a href="#add-user" onclick="addDesigner(<%= team.id %>)">Add Designers</a>
			</div>
		</div> <!-- end teams class -->
		<% end %>
	</div>
	<div class="col-sm-3 sidebar">
		<h2>Designers</h2>
		<ul id="designers-list" class="connected-sortable">
			<% @users.each do |designer| %>
			<li id="designer-<%=designer.id%>" data-designer-id="<%=designer.id%>"><%= designer.first_name %> <%= designer.last_name %>
			</li>
			<% end %>
		</ul>
	</div>
</div>


<div class="modal fade" id="add-user" tabindex="0" role="dialog" aria-hidden="true" aria-labelledby="add-user-label">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				<h4 class="modal-title" id="add-user-label">Add Designers</h4>
			</div>
			<div class="modal-body">
				<input id="add-user-input">
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">

	$("#designers-list, .team-list").sortable({
		connectWith: ".connected-sortable",
		receive: function(event, ui) {
			$.post("teams/" + $(this).data("team-id") + "/add_designer",{"user_id": ui.item.data("designer-id")});
		}
	});

	$(".team-list li").dblclick(function(ev){
		$(this).prependTo("#users-list");
	});
</script>